<!DOCTYPE html>
<html>
    <head>
        <title><%= title %></title>
        <link rel='stylesheet' href='/stylesheets/style.css' />
    </head>
  
    <!-- Cell board -->
    <style>
        #board-container tr, #board-container td {
            background: white;
            border: solid thin;
            padding: 5px 5px;
        }
        #board-container td.alive {
            background-color: black;
        }
        #board-container td:hover {
            background-color: dodgerblue;
        }
    </style>
    
    <body>
        <h1>Real-time collaborative Conway's Game of Life</h1>
        <div>
            <table id='board-container'>
                <% for(var x = 0; x < 32; x++) {%>
                    <tr>
                        <% for(var y = 0; y < 32; y++) {%>
                            <td cx='<%= x %>' cy='<%= y %>'></td>
                         <% } %>
                    </tr>
                <% } %>
            </table>
        </div>
        
        <button>Recreate</button>
        <button>Clear</button>
        <div id='array-container'></div>
    
        <script src="javascripts/vendor/jquery.js"></script>
        <script src="https://cdn.socket.io/socket.io-1.3.5.js"></script>
        <script>
            var socket = io.connect('http://localhost:8998');
            
            //Update from server
            socket.on('board update', function (data) {
                $('#array-container').html(JSON.stringify(data));
                for (x = 0; x < data.length; x++) {
                    for (y = 0; y < (data[x]).length; y++) {
                        //console.log(data[x][y]);
                        var item = ($($('#board-container tr')[x]).find('td')[y]);
                        if (data[x][y] >= 1) {
                            item.setAttribute('class', 'alive');
                        } else {
                            item.removeAttribute('class');
                        }
                    }
                }
            });
            
            //Draw on the board
            $('td').click(function cellClick() {
                var el = $(this);
                var coordinates = {x: el.attr('cx'), y: el.attr('cy'), pattern: [[0, 0, 0], [1, 1, 1], [0, 0, 0]]}
                console.log(coordinates);
                socket.emit('draw', coordinates);
            });
        </script>
    </body>
</html>
